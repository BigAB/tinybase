var e,t;e=this,t=function(e){"use strict";const t=e=>typeof e,s="",l=t(s),n=t(!0),a=t(0),r=t(t),o="type",c="default",i=e=>s+e,u=(e,t)=>e.forEach(t),d=(e,t)=>e.map(t),f=e=>e.length,h=(e,t,s)=>e.slice(t,s),T=(e,...t)=>e.push(...t),g=e=>JSON.stringify(e,((e,t)=>{return y(t,Map)?(s=(e,[t,s])=>(e[t]=s,e),l={},[...t].reduce(s,l)):t;var s,l})),b=JSON.parse,V=isFinite,y=(e,t)=>e instanceof t,S=e=>null==e,p=(e,t,s)=>S(e)?s?.():t(e),v=e=>e==l||e==n,w=e=>t(e)==r,m=(e,t)=>e?.has(t)??!1,I=e=>S(e)||0==(e=>e.size)(e),R=e=>e.clear(),C=(e,t)=>e?.forEach(t),J=(e,t)=>e?.delete(t),L=e=>new Map(e),E=e=>[...e?.keys()??[]],F=(e,t)=>e?.get(t),x=(e,t)=>C(e,((e,s)=>t(s,e))),z=(e,t,s)=>S(s)?(J(e,t),e):e?.set(t,s),O=(e,t,s)=>(m(e,t)||z(e,t,s()),F(e,t)),j=(e,t,s)=>{const l={},n=t??(e=>e);return C(e,((e,t)=>p(n(e),(e=>s?.(e)?0:l[t]=e)))),l},k=(e,t)=>{const s=L(),l=t??(e=>e);return C(e,((e,t)=>s.set(t,l(e)))),s},A=e=>k(e,k),M=(e,t,s,l,n=0)=>p((s?O:F)(e,t[n],n>f(t)-2?s:L),(a=>{if(n>f(t)-2)return l?.(a)&&z(e,t[n]),a;const r=M(a,t,s,l,n+1);return I(a)&&z(e,t[n]),r})),N=e=>new Set(Array.isArray(e)||S(e)?e:[e]),P=(e,t)=>e?.add(t),B=/^\d+$/,D=()=>{const e=[];let t=0;return[l=>(l?e.shift():null)??s+t++,t=>{B.test(t)&&f(e)<1e3&&T(e,t)}]},W=Object,$=W.keys,q=W.isFrozen,G=W.freeze,H=e=>y(e,W)&&e.constructor==W,K=(e,t)=>!S(((e,t)=>p(e,(e=>e[t])))(e,t)),Q=(e,t)=>delete e[t],U=(e,t)=>d(W.entries(e),(([e,s])=>t(s,e))),X=e=>{return H(e)&&(t=$(e),0==f(t));var t},Y=e=>[e,e],Z=()=>[L(),L()],_=e=>{const s=t(e);return v(s)||s==a&&V(e)?s:void 0},ee=(e,t,s,l=z)=>(U(t,((t,l)=>s(e,l,t))),x(e,(s=>K(t,s)?0:l(e,s))),e),te=(e,t,s)=>S(e)||!H(e)||X(e)||q(e)?(s?.(),!1):(U(e,((s,l)=>{t(s,l)||Q(e,l)})),!X(e)),se=(e,t,s)=>z(e,t,F(e,t)==-s?void 0:s),le=()=>{let e,t,l,n,r=0;const V=L(),y=L(),B=L(),W=L(),$=L(),q=L(),H=L(),ne=L(),ae=L(),re=L(),oe=L(),ce=L(),ie=N(),ue=L(),de=L(),fe=L(),he=Z(),Te=Z(),ge=Z(),be=Z(),Ve=Z(),ye=Z(),Se=Z(),pe=Z(),ve=Z(),we=Z(),me=Z(),Ie=Z(),Re=Z(),Ce=Z(),[Je,Le,Ee,Fe]=(e=>{let t;const[l,n]=D(),a=L();return[(e,n,r,o=[],c=(()=>[]))=>{t??=Pt;const i=l(1);return z(a,i,[e,n,r,o,c]),P(M(n,r??[s],N),i),i},(e,l,...n)=>u(((e,t=[s])=>{const l=[],n=(e,s)=>s==f(t)?T(l,e):null===t[s]?C(e,(e=>n(e,s+1))):u([t[s],null],(t=>n(F(e,t),s+1)));return n(e,0),l})(e,l),(e=>C(e,(e=>F(a,e)[0](t,...l??[],...n))))),e=>p(F(a,e),(([,t,l])=>(M(t,l??[s],void 0,(t=>(J(t,e),I(t)?1:0))),z(a,e),n(e),l))),e=>p(F(a,e),(([e,,s=[],l,n])=>{const a=(...r)=>{const o=f(r);o==f(s)?e(t,...r,...n(r)):S(s[o])?u(l[o]?.(...r)??[],(e=>a(...r,e))):a(...r,s[o])};a()}))]})(),xe=e=>{if(!te(e,((e,t)=>[o,c].includes(t))))return!1;const t=e.type;return!(!v(t)&&t!=a||(_(e.default)!=t&&Q(e,c),0))},ze=(t,s)=>(!e||m(ae,s)||ct(s))&&te(t,((e,t)=>Oe(s,t,e)),(()=>ct(s))),Oe=(e,t,s,l)=>te(l?s:Me(s,e,t),((l,n)=>p(je(e,t,n,l),(e=>(s[n]=e,!0)),(()=>!1))),(()=>ct(e,t))),je=(t,s,l,n)=>e?p(F(F(ae,t),l),(e=>_(n)!=e.type?ct(t,s,l,n,e.default):n),(()=>ct(t,s,l,n))):S(_(n))?ct(t,s,l,n):n,ke=(e,t)=>te(t?e:Ne(e),((t,s)=>p(Ae(s,t),(t=>(e[s]=t,!0)),(()=>!1))),(()=>it())),Ae=(e,s)=>t?p(F(oe,e),(t=>_(s)!=t.type?it(e,s,t.default):s),(()=>it(e,s))):S(_(s))?it(e,s):s,Me=(e,t,s)=>(p(F(re,t),(([l,n])=>{C(l,((t,s)=>{K(e,s)||(e[s]=t)})),C(n,(l=>{K(e,l)||ct(t,s,l)}))})),e),Ne=e=>(t&&(C(ce,((t,s)=>{K(e,s)||(e[s]=t)})),C(ie,(t=>{K(e,t)||it(t)}))),e),Pe=e=>ee(ae,e,((e,t,s)=>{const l=L(),n=N();ee(O(ae,t,L),s,((e,t,s)=>{z(e,t,s),p(s.default,(e=>z(l,t,e)),(()=>P(n,t)))})),z(re,t,[l,n])}),((e,t)=>{z(ae,t),z(re,t)})),Be=e=>ee(oe,e,((e,t,s)=>{z(oe,t,s),p(s.default,(e=>z(ce,t,e)),(()=>P(ie,t)))}),((e,t)=>{z(oe,t),z(ce,t),J(ie,t)})),De=e=>X(e)?zt():Jt(e),We=e=>ee(de,e,((e,t,s)=>$e(t,s)),((e,t)=>Ze(t))),$e=(e,t)=>ee(O(de,e,(()=>(st(e,1),L()))),t,((t,s,l)=>qe(e,t,s,l)),((t,s)=>_e(e,t,s))),qe=(e,t,s,l,n)=>ee(O(t,s,(()=>(lt(e,s,1),L()))),l,((t,l,n)=>Ge(e,s,t,l,n)),((l,a)=>et(e,t,s,l,a,n))),Ge=(e,t,s,l,n)=>{m(s,l)||nt(e,t,l,1);const a=F(s,l);n!==a&&(at(e,t,l,a,n),z(s,l,n))},He=(e,t,s,l,n)=>p(F(t,s),(t=>Ge(e,s,t,l,n)),(()=>qe(e,t,s,Me({[l]:n},e,s)))),Ke=e=>X(e)?Ot():Lt(e),Qe=e=>ee(fe,e,((e,t,s)=>Ue(t,s)),((e,t)=>tt(t))),Ue=(e,t)=>{m(fe,e)||rt(e,1);const s=F(fe,e);t!==s&&(ot(e,s,t),z(fe,e,t))},Xe=(e,t)=>{const[s]=O(ue,e,D),l=s(t);return m(F(de,e),l)?Xe(e,t):l},Ye=e=>F(de,e)??$e(e,{}),Ze=e=>$e(e,{}),_e=(e,t,s)=>{const[,l]=O(ue,e,D);l(s),qe(e,t,s,{},!0)},et=(e,t,s,l,n,a)=>{const r=F(F(re,e)?.[0],n);if(!S(r)&&!a)return Ge(e,s,l,n,r);const o=t=>{at(e,s,t,F(l,t)),nt(e,s,t,-1),z(l,t)};S(r)?o(n):x(l,o),I(l)&&(lt(e,s,-1),I(z(t,s))&&(st(e,-1),z(de,e),z(ue,e)))},tt=e=>{const t=F(ce,e);if(!S(t))return Ue(e,t);ot(e,F(fe,e)),rt(e,-1),z(fe,e)},st=(e,t)=>se(V,e,t),lt=(e,t,s)=>se(O(y,e,L),t,s),nt=(e,t,s,l)=>se(O(O(B,e,L),t,L),s,l),at=(e,t,s,l,n)=>O(O(O(W,e,L),t,L),s,(()=>[l,0]))[1]=n,rt=(e,t)=>se($,e,t),ot=(e,t,s)=>O(q,e,(()=>[t,0]))[1]=s,ct=(e,t,s,l,n)=>(T(O(O(O(H,e,L),t,L),s,(()=>[])),l),n),it=(e,t,s)=>(T(O(ne,e,(()=>[])),t),s),ut=(e,t,s)=>p(F(F(F(W,e),t),s),(([e,t])=>[!0,e,t]),(()=>[!1,...Y(mt(e,t,s))])),dt=e=>p(F(q,e),(([e,t])=>[!0,e,t]),(()=>[!1,...Y(Ct(e))])),ft=e=>I(H)||I(ve[e])?0:C(e?k(H,A):H,((t,s)=>C(t,((t,l)=>C(t,((t,n)=>Le(ve[e],[s,l,n],t))))))),ht=e=>I(ne)||I(we[e])?0:C(e?k(ne):ne,((t,s)=>Le(we[e],[s],t))),Tt=(e,t,s)=>{if(!I(t))return Le(e,s),1},gt=e=>{const t=I(Ve[e]),s=I(Se[e])&&I(be[e])&&t&&I(Te[e]),l=I(pe[e])&&I(ye[e])&&I(ge[e])&&I(he[e]);if(!s||!l){const n=e?[k(V),A(y),k(B,A),k(W,A)]:[V,y,B,W];if(!s){C(n[2],((t,s)=>C(t,((t,l)=>Tt(Se[e],t,[s,l])))));const s=N();C(n[1],((l,n)=>{Tt(be[e],l,[n])&&!t&&(Le(Ve[e],[n,null]),P(s,n))})),t||C(n[3],((t,l)=>{if(!m(s,l)){const s=N();C(t,(e=>C(e,(([t,l],n)=>l!==t?P(s,n):J(e,n))))),C(s,(t=>Le(Ve[e],[l,t])))}})),Tt(Te[e],n[0])}if(!l){let t;C(n[3],((s,l)=>{let n;C(s,((s,a)=>{let r;C(s,(([s,o],c)=>{o!==s&&(Le(pe[e],[l,a,c],o,s,ut),t=n=r=1)})),r&&Le(ye[e],[l,a],ut)})),n&&Le(ge[e],[l],ut)})),t&&Le(he[e],void 0,ut)}}},bt=e=>{const t=I(Ie[e]),s=I(Re[e])&&I(me[e]);if(!t||!s){const l=e?[k($),k(q)]:[$,q];if(t||Tt(Ie[e],l[0]),!s){let t;C(l[1],(([s,l],n)=>{l!==s&&(Le(Re[e],[n],l,s,dt),t=1)})),t&&Le(me[e],void 0,dt)}}},Vt=(e,...t)=>(At((()=>e(...d(t,i)))),Pt),yt=()=>j(de,(e=>j(e,j))),St=()=>E(de),pt=e=>E(F(de,i(e))),vt=(e,t,s,l=0,n)=>{return d(h((r=F(de,i(e)),o=(e,s)=>[S(t)?s:F(e,i(t)),s],a=([e],[t])=>(e<t?-1:1)*(s?-1:1),d([...r?.entries()??[]],(([e,t])=>o(t,e))).sort(a)),l,S(n)?n:l+n),(([,e])=>e));var a,r,o},wt=(e,t)=>E(F(F(de,i(e)),i(t))),mt=(e,t,s)=>F(F(F(de,i(e)),i(t)),i(s)),It=()=>j(fe),Rt=()=>E(fe),Ct=e=>F(fe,i(e)),Jt=e=>Vt((()=>(e=>te(e,ze,ct))(e)?We(e):0)),Lt=e=>Vt((()=>ke(e)?Qe(e):0)),Et=e=>{try{De(b(e))}catch{}return Pt},Ft=t=>Vt((()=>{if((e=te(t,(e=>te(e,xe))))&&(Pe(t),!I(de))){const e=yt();zt(),Jt(e)}})),xt=e=>Vt((()=>{if(t=(e=>te(e,xe))(e)){const s=It();kt(),Ot(),t=!0,Be(e),Lt(s)}})),zt=()=>Vt((()=>We({}))),Ot=()=>Vt((()=>Qe({}))),jt=()=>Vt((()=>{Pe({}),e=!1})),kt=()=>Vt((()=>{Be({}),t=!1})),At=(e,t)=>{if(-1==r)return;Mt();const s=e();return Nt(t),s},Mt=()=>(r++,Pt),Nt=e=>(r>0&&(r--,0==r&&(l=!I(W),n=!I(q),r=1,ft(1),l&&gt(1),ht(1),n&&bt(1),r=-1,e?.(j(W,(e=>j(e,(e=>j(e,(e=>[...e]),(([e,t])=>e===t))),X)),X),j(H,(e=>j(e,j))),j(q,(e=>[...e]),(([e,t])=>e===t)),j(ne))&&(r=1,C(W,((e,t)=>C(e,((e,s)=>C(e,(([e],l)=>((e,t,s,l,n)=>S(n)?e.delCell(t,s,l,!0):e.setCell(t,s,l,n))(Pt,t,s,l,e))))))),C(q,(([e],t)=>((e,t,s)=>S(s)?e.delValue(t):e.setValue(t,s))(Pt,t,e))),r=-1,l=n=!1),Le(Ce[0],void 0,l,n),ft(0),l&&gt(0),ht(0),n&&bt(0),Le(Ce[1],void 0,l,n),r=0,u([V,y,B,W,H,$,q,ne],R))),Pt),Pt={getTables:yt,getTableIds:St,getTable:e=>j(F(de,i(e)),j),getRowIds:pt,getSortedRowIds:vt,getRow:(e,t)=>j(F(F(de,i(e)),i(t))),getCellIds:wt,getCell:mt,getValues:It,getValueIds:Rt,getValue:Ct,hasTables:()=>!I(de),hasTable:e=>m(de,i(e)),hasRow:(e,t)=>m(F(de,i(e)),i(t)),hasCell:(e,t,s)=>m(F(F(de,i(e)),i(t)),i(s)),hasValues:()=>!I(fe),hasValue:e=>m(fe,i(e)),getTablesJson:()=>g(de),getValuesJson:()=>g(fe),getJson:()=>g([de,fe]),getTablesSchemaJson:()=>g(ae),getValuesSchemaJson:()=>g(oe),getSchemaJson:()=>g([ae,oe]),setTables:Jt,setTable:(e,t)=>Vt((e=>ze(t,e)?$e(e,t):0),e),setRow:(e,t,s)=>Vt(((e,t)=>Oe(e,t,s)?qe(e,Ye(e),t,s):0),e,t),addRow:(e,t,s=!0)=>At((()=>{let l;return Oe(e,l,t)&&(e=i(e),qe(e,Ye(e),l=Xe(e,s?1:0),t)),l})),setPartialRow:(e,t,s)=>Vt(((e,t)=>{if(Oe(e,t,s,1)){const l=Ye(e);U(s,((s,n)=>He(e,l,t,n,s)))}}),e,t),setCell:(e,t,s,l)=>Vt(((e,t,s)=>p(je(e,t,s,w(l)?l(mt(e,t,s)):l),(l=>He(e,Ye(e),t,s,l)))),e,t,s),setValues:Lt,setPartialValues:e=>Vt((()=>ke(e,1)?U(e,((e,t)=>Ue(t,e))):0)),setValue:(e,t)=>Vt((e=>p(Ae(e,w(t)?t(Ct(e)):t),(t=>Ue(e,t)))),e),setTablesJson:Et,setValuesJson:e=>{try{Ke(b(e))}catch{}return Pt},setJson:e=>{try{const[t,s]=b(e);De(t),Ke(s)}catch{Et(e)}return Pt},setTablesSchema:Ft,setValuesSchema:xt,setSchema:(e,t)=>Vt((()=>{Ft(e),xt(t)})),delTables:zt,delTable:e=>Vt((e=>m(de,e)?Ze(e):0),e),delRow:(e,t)=>Vt(((e,t)=>p(F(de,e),(s=>m(s,t)?_e(e,s,t):0))),e,t),delCell:(e,t,s,l)=>Vt(((e,t,s)=>p(F(de,e),(n=>p(F(n,t),(a=>m(a,s)?et(e,n,t,a,s,l):0))))),e,t,s),delValues:Ot,delValue:e=>Vt((e=>m(fe,e)?tt(e):0),e),delTablesSchema:jt,delValuesSchema:kt,delSchema:()=>Vt((()=>{jt(),kt()})),transaction:At,startTransaction:Mt,finishTransaction:Nt,forEachTable:e=>C(de,((t,s)=>e(s,(e=>C(t,((t,s)=>e(s,(e=>x(t,e))))))))),forEachRow:(e,t)=>C(F(de,i(e)),((e,s)=>t(s,(t=>x(e,t))))),forEachCell:(e,t,s)=>x(F(F(de,i(e)),i(t)),s),forEachValue:e=>x(fe,e),addSortedRowIdsListener:(e,t,s,l,n,a,r)=>{let o=vt(e,t,s,l,n);return Je((()=>{const r=vt(e,t,s,l,n);var c,i,u;i=o,f(c=r)===f(i)&&(u=(e,t)=>i[t]===e,c.every(u))||(o=r,a(Pt,e,t,s,l,n,o))}),Ve[r?1:0],[e,t],[St])},addWillFinishTransactionListener:e=>Je(e,Ce[0]),addDidFinishTransactionListener:e=>Je(e,Ce[1]),callListener:e=>(Fe(e),Pt),delListener:e=>(Ee(e),Pt),getListenerStats:()=>({}),createStore:le};return U({Tables:[0,he],TableIds:[0,Te],Table:[1,ge,[St]],RowIds:[1,be,[St]],Row:[2,ye,[St,pt]],CellIds:[2,Se,[St,pt]],Cell:[3,pe,[St,pt,wt],e=>Y(mt(...e))],InvalidCell:[3,ve],Values:[0,me],ValueIds:[0,Ie],Value:[1,Re,[Rt],e=>Y(Ct(e[0]))],InvalidValue:[1,we]},(([e,t,s,l],n)=>{Pt["add"+n+"Listener"]=(...n)=>Je(n[e],t[n[e+1]?1:0],e>0?h(n,0,e):void 0,s,l)})),G(Pt)};e.createStore=le},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseStore={});
